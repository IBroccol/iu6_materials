#### 31. Понятие графа. Ориентированные и неориентированные графы. Мультиграф. Простой, полный, дополнительный графы.

**Опр.** **Графом** $G(X,U)$ называется математический объект, заданный парой множеств $X = \lbrace x_1,x_2,...,x_n \rbrace$ - множество вершин графа, и $U = \lbrace u_1,u_2,...,u_n \rbrace$ - множество рёбер графа.

**Опр.** Если пара вершин графа $x_i,x_j$ - неупорядоченные вершины и они соединены ребром $u_l = \{ x_i,x_j \}$, то такое ребро называется **неориентированным**.  

**Опр.** Если пара вершин графа $x_i,x_j$ - упорядоченные вершины и они соединены ребром $u_l = (x_i,x_j)$, то такое ребро называется **ориентированным**.

**Опр.** Граф, состоящий только из неориентированных ребер, называется **неориентированным**. Если же граф состоит только из ориентированных ребер, то он называется **ориентированным**. 

**Опр.** Если в графе хотя бы одну пару вершин связывает более чем одно ребро, то такой граф называется **мультиграфом**.

**Опр.** Если концевые вершины ребра совпадают, то такое ребро называется **петлей.**

**Опр.** Если два ребра инциденты одним и тем же двум вершинам, то такие ребра называются **кратными**. 

**Опр.** Граф называется **простым**, если в нем нет петель и кратных ребер.

**Опр.** Граф называется **полным**, если две любые его вершины смежны.

**Опр.** Граф $\overline G(X,\overline U)$ называется **дополнительным** к графу $G(X,U)$, если множество его вершин совпадает с множеством вершин графа $G$, а множество рёбер $\overline U = U_п \setminus U$, где $U_п$ - множество рёбер соответствующего полного графа. Т.е. в дополнительном графе две вершины инциденты одному и тому же ребру тогда и только тогда, когда это ребро отсутствует в исходном графе.

---
#### 32. Отношения смежности и инцидентности в графах. Порядок графа, степень и полустепени вершин.

**Опр.** Вершина $x_i$ инцидента ребру $u_l$, если является одной из её концевых вершин. 

**Опр.** Два ребра называются **смежными**, если они имеют общую концевую вершину. (Две вершины называются смежными, если они являются концевыми вершинами одного и того же ребра.)

Отношение инцидентности справедливо для разнородных компонентов (ребро - вершина), а отношение смежности - для однородных (ребро - ребро, вершина - вершина).

**Опр.** Мощность вершин графа $| X | = n$ называется **порядком** графа.

**Опр.** Число ребер, инцидентных вершине $x_i \in X$, называется её **степенью**.

В случае орграфа определены:
- $p^+(x_i)$ - **полустепень захода** (количество входящих в $x_i$ ориентированных ребер). 
- $p^-(x_i)$ - **полустепень исхода** (количество исходящих из $x_i$ ориентированных ребер). 

**Опр.** Если $p(x_{i}) = 1$, то вершина $x_{i}$ называется висячей
**Опр.** Если $p(x_{i}) = 0$, то вершина $x_{i}$ называется изолированной
Для любой вершины выполняется: $p(x_i) = p^+(x_i) + p^-(x_i)$.

---
#### 33. Способы задания графов.
##### 1. Матричный способ:
- Матрица смежности - квадратная матрица $M$ порядка $n$ - количество вершин.
	$M_{ij}= 1$, если $x_i$ смежно $x_j$
	$M_{ij}= 0$, если $x_i$ не смежно $x_j$
	
|       | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | $x_6$ |
| ----- | ----- | ----- | ----- | ----- | ----- | ----- |
| $x_1$ |       | 1     |       | 1     | 1     |       |
| $x_2$ | 1     |       | 1     |       |       |       |
| $x_3$ |       | 1     |       |       |       |       |
| $x_4$ | 1     |       |       |       |       |       |
| $x_5$ | 1     |       |       |       |       | 1     |
| $x_6$ |       |       |       |       | 1     |       |
Она симметрична относительно главной диагонали для неориентированного графа. 

- Матрица инцидентностей - прямоугольная матрица $n \times m$, где $n$ - порядок графа, $m$ - число ребер.
Для неориентированных графов:
-  $H_{ij}$ = 1, если $x_i$ инцидентна $u_j$
-  $H_{ij}$ = 0, иначе
-  Сумма столбца = 2

Для ориентированных графов:
-  $H_{ij}$ = 1, если $x_i$ инцидента $u_j$ и является конечной для него
-  $H_{ij}$ = 0, если $x_i$ не инцидента $u_j$
-  $H_{ij}$ = −1, если $x_i$ инцидента $u_j$ и является начальной для него
-  Сумма столбца = 0

По строкам матрицы можно вычислить степени и полустепени вершин.
##### 2. Аналитический (основан на понятии отображения.):
- **Обозначение.** $\Gamma_{x_i}$ - прямое отображение вершины $x_i$.
	$\Gamma_{x_1} = \lbrace x_2 \rbrace$ - исходящие ребра.ыячч
	$\Gamma^{-1}_{x_2} = \lbrace x_1 \rbrace$ - входящие ребра.
##### 3. Списком (Вектором Айлифа):

![[Pasted image 20240610143350.png]]
##### 4. Массив вершин/ребер:

| Откуда | Куда  |
| ------ | ----- |
| $x_1$  | $x_2$ |
| $x_5$  | $x_1$ |
| $x_1$  | $x_4$ |
| $x_3$  | $x_2$ |
| $x_5$  | $x_6$ |

--- 
#### 34. Части графа: подграфы и суграфы. Изоморфизм графов.

**Опр.** $G_1(X_1,U_1)$ - называется **частью** графа $G(X,U)$, если он находится в отношении включения к нему: $X_1 \subseteq X, U_1 \subseteq U$. ($G_1 \subseteq G$)

**Опр.** Часть графа называется **подграфом** графа $G(X,U)$, если он находится в отношении строгого включения к нему: $X_1 \subset X, U_1 \subset U$. ($G_1 \subset G$) 

**Опр.** Часть графа называется **суграфом**, если $X_1 = X$, а $U_1 \subseteq U$ 

**Опр.** Есть два графа $G_1(X_1,U_1)$ и $G_2(X_2,U_2)$. Они называются **изоморфными**, если между множествами вершин $X_1$ и $X_2$ установлено взаимно однозначное соответствие, такое, что между множествами $U_1$ и $U_2$ устанавливается также взаимно однозначное соответствие, а именно: каждое ребро из множества $U_2$ инцидентно двум своим концевым вершинам тогда и только тогда, когда соответствующие им вершины из множества $X_1$ инцидентны ребру из множества $U_1$.

Из определения следует, что в случае изоморфного графа существует две биекции:
- $f_1: X_1 \leftrightarrow X_2$
- $f_2: U_1 \leftrightarrow U_2$

**Теорема.** Изоморфизм графом является отношением эквивалентности.

---
#### 35. Теоретико-множественные операции на графах.
Все операции описаны для неографов. Даны графы $G_{1}(S_{1}, U_{1})$ и $G_{2}(S_{2},U_{2})$
1. **Объединением** графов $G_{1}$ и $G_{2}$ называется граф $G(S, U) = G_{1} \cup G_{2}$ такой, что $S = S_{1} \cup S_{2}, U = U_{1} \cup U_{2}$
2. **Пересечением** графов $G_{1}$ и $G_{2}$ называется граф $G(S, U) = G_{1} \cap G_{2}$ такой, что $S = S_{1} \cap S_{2}, U = U_{1} \cap U_{2}$
3. **Дополнительным графом** к графу $G(S, U)$ называется граф $\overline G(S, U)$, состоящий из того же множества вершин, что и граф $G$, и множества рёбер $\overline U = U_{п} \setminus U$, где $U_{п}$ - множество рёбер соответствующего полного графа.
4. **Композицией** графов $G_{1}$ и $G_{2}$ называется граф $G(S, U) = G_{1} \circ G_{2}$, в котором каждое ребро $(x_{i}, x_{j})$ присутствует тогда и только тогда, когда в графе $G_{1}$ имеется ребро $(x_{i}, x_{p}) \in U_{1}$, а в графе $G_{2}$ - ребро $(x_{p}, x_{j}) \in U_{2}$. При этом имеется в виду, что либо $S = S_{1} = S_{2}$, либо $S = S_{1} \cup S_{2}$.
5. **Удалением вершины** $v$ из графа $G(S, U)$ называется операция, дающая граф $G - v$, в котором множество вершин есть $S \setminus \{v\}$, а множество рёбер $U' = \{u | u \in U \setminus E \}$, где $E \subset U$ и каждое ребро $u_{i} \in E$ инцидентно вершине $v$.
6. **Удалением ребра** $u$ из графа $G(S, U)$ называется операция, дающая граф $G - u$, в котором множество вершин совпадает с множеством вершин исходного графа, множество рёбер есть $U \setminus \{ u \}$
7. **Добавлением ребра** $u$ в граф $G(S, U)$ называется операция, дающая граф $G + u$, в котором множество вершин совпадает с множеством вершин исходного графа, а множество рёбер есть множество $U \cup \{ u \}$
8. **Стягиванием ребра** $u = (x_{i}, x_{j})$ графа $G(S, U)$, где $u \in U, \{ x_{i}, x_{j} \} \subset S$, называется называется операция, дающая граф с множеством рёбер $U \setminus \{ u \}$ при отождествлении вершин $x_{i}$ и $x_{j}$ одной вершине $v$, когда рёбра, инцидентные вершинам $x_{i}$ и $x_{j}$ в исходном графе, становятся инцидентными вершине $v$ полученного графа. Обозначение: $G / u$

---

#### 36. Маршрут, цепь, цикл, путь, контур в графе. Прямое и обратное транзитивные замыкания.

**Опр.** **Маршрутом**, соединяющим вершины $x_i$ и $x_j$ в графе, называется чередующаяся последовательность $x_iu_kx_lu_p...u_lx_j$. (Достаточно указывать последовательность вершин $x_i,x_l,...,x_j$)

**Опр.** Маршрут без повторяющихся ребер называется **цепью**.
**Опр.** Цепь, все вершины которой различны, называется **простой цепью.**
**Опр.** Простая цепь, начальные и конечные вершины которой совпадают, называется **циклом**.
**Опр.** Цепь в ориентированном графе называется **путем**.
**Опр.** Цикл в орграфе называется **контуром**.

**Опр.** Прямым транзитивным замыканием $\widehat\Gamma_{x_i}$  вершины $x_i$ называется объединение кратных отображений (отображения высших порядков): 
$\widehat \Gamma_{x_i} = \lbrace x_i \rbrace \cup \Gamma_{x_i} \cup \Gamma^2_{x_i} \cup ... \cup \Gamma^n_{x_i} \cup ...$ 

**Опр.** Обратным транзитивным замыканием $\widehat\Gamma^{-1}_{x_i}$ вершины $x_i$ называется объединение всех обратных кратных отображений:
$\widehat \Gamma^{-1}_{x_i} = \lbrace x_i \rbrace \cup \Gamma^{-1}_{x_i} \cup \Gamma^{-2}_{x_i} \cup ... \cup \Gamma^{-n}_{x_i} \cup ...$ 

---
#### 37. Понятие связности в графе. Простая и сильная связность. Компоненты связности. Алгоритм Мальгранжа разложения орграфа на компоненты сильной связности.

**Опр.** Неориентированный граф является **связным** тогда и только тогда, когда любые две его различные вершины можно соединить маршрутом. (Для любой вершины $x_i \in X$ выполняется условие: $\widehat \Gamma_{x_i} = X$)

**Опр.** **Сильная связность** в орграфе подразумевает, что между двумя любыми вершинами существует именно путь (учитывается направление).
**Опр.** **Слабая связность** игнорирует направление.

Отношение связности на множестве вершин является отношением эквивалентности.

Отношение связности разбивает множество вершин графа на классы эквивалентности, которые называют **компонентами сильной связности графа**.

Для разложения орграфа на компоненты сильной связности существует **алгоритм Мальгранжа**.
Его теоретическая основа:
- Каждая вершина графа может принадлежать только одной компоненте сильной связности и эта компонента ищется следующим образом: $C_{x_i} = \widehat \Gamma_{x_i} \cap \widehat \Gamma^{-1}_{x_i}$ 

Шаги алгоритма:
1) Для произвольной вершины $x_i$ находим соответствующий ей класс $C_{x_i}$ по следующей формуле: $C_{x_i} = \widehat \Gamma_{x_i} \cap \widehat \Gamma^{-1}_{x_i}$.
2) Вершины, которые вошли в этот класс удаляем из графа
3) Повторяем шаги 1 и 2 пока не удалим весь граф.

--- 
#### 38. Соответствие понятий маршрута и связности. Точка сочленения графа и теорема о ней. Понятие i-связного графа.

Граф является связным тогда и только тогда, когда две различные его вершины можно соединить маршрутом.

**Опр.** Вершина графа называется точкой сочленения графа, если её удаление из графа увеличит число компонент связности графа (если она существует, то граф называется разделимым, иначе - неразделимым).

**Теорема.** Вершина $x_k$ является точкой сочленения связного графа $G(X,U)$, если и только если, в графе существуют две такие различные вершины $x_i$ и $x_j$, что любой путь или любая цепь между вершинами $x_i$ и $x_k$ проходит через $x_k$.

**Опр.** Граф называется $i$-связным, если для нарушения его связности необходимо удалить не менее $i$ вершин.

--- 
#### 39. Теорема (Эйлера) об эйлеровом цикле в связном неографе.
**Опр.** Эйлеровым циклом в неографе называется цикл, включающий в себя все рёбра графа, и проходящий по каждому ребру ровно один раз. Граф, содержащий Эйлеровый цикл, называется Эйлеровым. 

**Теорема Эйлера.** Граф является эйлеровым тогда и только тогда, когда все его вершины имеют чётную степень (для неографов).
**Доказательство.**
**Необходимость** ($\Rightarrow$).
Пусть связный неограф $G$ эйлеров. Следовательно, цикл в $G$ проходит через каждую вершину. Для каждой вершины верно: цикл входит в вершину по одному ребру, а выходит по другому. Таким образом, каждая вершина инцидентна чётному числу рёбер. Так как эйлеров цикл, согласно определению, содержит все рёбра графа, то степени всех вершин чётны.
**Достаточность ($\Leftarrow$).**
Пусть степени всех вершин связного неографа $G$ чётны. Начнём построение цепи $C_1$ из вершины $x_1$. Попав в очередную вершину $x_i$ по некоторому ребру, всегда возможно выйти из неё по другому ребру, так как степень каждому вершины чётная. Тогда окончание цепи $C_1$придётся на вершину $x_1$, то есть $C_1$ будет циклом. Если при получении цикла $C_1$ были пройдены все ребра графа $G$, то $G$ - эйлеров граф.

Если были пройдены не все рёбра графа, то будем считать, что пройденные рёбра помечены. Тогда для любой вершины, имеющей непомеченные рёбра среди инцидентных ей рёбер, верно: число непомеченных рёбер чётное. Найдём первую такую вершину $x_i$ и начнём от неё построение цепи $C_2$ по непомеченным рёбрам. В силу чётности степеней всех вершин и чётности числа непомеченных рёбер имеем: $C_2$ заканчивается в вершине $x_i$ и будет циклом. Так как граф связный, то циклы $C_1$, $C_2$ имеют точку пересечения $x_i$. Если после построения цикла $C_2$ в графе ещё остались непомеченные рёбра, аналогично описанному
выше строится цикл $C_3$ и т.д., пока непомеченных рёбер не останется. Так как каждый из построенных циклов $C_1$, $C_2$, . . . , $C_n$ является эйлеровым подграфом графа $G$, то в силу связности графа $G$ получаем: граф $G$ - эйлеров $\small\triangle$. 


--- 
#### 40. Эйлеров обход в графе. Алгоритм Флёри построения эйлерова цикла в связном неографе.

**Опр.** **Эйлеровым циклом (обходом)** в неографе называется цикл, включающий в себя все рёбра графа, и проходящий по каждому ребру ровно один раз. Граф, содержащий эйлеровый цикл, называется Эйлеровым. 

Для эйлеровых графов существует алгоритм Флёри для построения одного из возможных эйлеровых циклов. Его шаги:
1. Выбираем вершину $x_i$, рассматриваем произвольное ребро и помечаем его как первое, переходим в вершину $x_{i+1}$.
2. Циклически повторяем пункт 1 для $x_{i+1}$, в качестве номеров используем последовательные натуральные числа.
3. Находясь в вершине $x_l$ не следует:
	-  Выбирать инцидентное ребро, второй концевой вершиной которого является предыдущая вершина, если есть другие варианты.
	-  Выбирать ребро-перешеек, то есть такое ребро, удаление которого нарушит связность графа.

---


#### 41. Гамильтоновы графы. Теорема Оре о гамильтоновом цикле в связном неографе.

**Опр.** Гамильтоновым циклом в неографе называется цикл, содержащий вершины графа и проходящий через каждую вершину ровно 1 раз.

Пример:
![[Pasted image 20240610181447.png]]

Критериев Гамильтоновости столь же простых как критерий эйлеровости не существует, но существует ряд теорем о достаточных условиях Гамильтоновости. О необходимости нет.

**Теорема Оре.** Дан неограф $G(X,U)$ порядка $n \geq 2$. Если для любой пары несмежных вершин $x_i,x_j$ выполняется неравенство $p(x_i)+p(x_j) \geq n$, то $G$ - Гамильтонов граф. 

---
#### 42. Эйлеровость и гамильтоновость в орграфах.
##### Эйлеровость 
Дан орграф $G(X, U)$
1) Если $G$ - эйлеров, то $\forall x \in X \; p^+(x_{i}) = p^-(x_{i})$
2) Если $G$ - эйлеров, то он является объединением контуров, не пересекающихся по рёбрам.

**Теорема.** Связный орграф $G(X, U)$ содержит открытый эйлеров путь тогда и только тогда, когда в нём найдётся 2 различных вершины $x, y \; (x \neq y)$ такие, что $p^-(x) = p^+(x) + 1$ и $p^-(y) = p^+(y) - 1$, а для всякой иной вершины $x_{i} \in X \setminus {x, y}$ верно $p^-(x_{i}) = p^+(x_{i})$
##### Гамильтоновость
Можно только проверить с помощью достаточного условия

**Теорема.** (одно из *достаточных* условий)
Дан сильно связный орграф $G(X, U)$ без петель и кратных рёбер порядка $n \geq 2$. Если для любой пары различных несмежных вершин $x_{i}, x_{j}$ выполняется неравенство $p(x_{i}) + p(x_{j}) \geq 2n - 1$, то орграф $G$ содержит Гамильтонов контур.
- Если теорема выполняется, то гарантированно существует гамильтонов обход, а если не выполняется, то он может как быть, так и не быть.
---
#### 43. Паросочетания. Двудольные графы. Задача о назначениях.

**Опр.** **Паросочетанием** в неографе называется множество попарно **несмежных** ребер.
Например, для графа из последовательно соединённых 6 вершин: $x_{1} - x_{2} - x_{3} - x_{4} - x_{5} - x_{6}$ возможны паросочетания:
- $\{ (x_{1}, x_{2}), (x_{3}, x_{4}), (x_{5}, x_{6}) \}$
- $\{ (x_{2}, x_{3}), (x_{4}, x_{5}) \}$

**Опр.** Максимальным паросочетание называется паросочетание, в которое больше нельзя добавить ребро.
**Опр.** Паросочетание наибольшей мощности называется паросочетание из наибольшего возможного количества рёбер.
**Опр.** Совершенным паросочетанием называется паросочетание, охватывающее все вершины.

**Опр.** Граф называется **двудольным**, если множество его вершин можно разбить на два непересекающихся множества $X_1$ и $X_2$, таких, что для любого ребра верно, что одна из его вершин принадлежит $X_1$, а вторая $X_2$, или наоборот. 

**Задача о назначениях.** Задача нахождения требуемого набора паросочетаний во взвешенном двудольном графе в зависимости от условий задачи.
**Пример.** Распределение задач между работниками может производиться как поиск паросочетаний в двудольном графе.

---
#### 44. Планарные графы. Понятие грани. Теорема Эйлера о плоском графе и следствия из нее. Теорема «о пяти красках».
**Опр.** **Укладкой** графа на плоскость называют процесс получения такого изображения
графа, что все его вершины становятся точками одной плоскости, а ребра – линиями на той же плоскости без самопересечений, причем никакие два ребра не имеют общих точек, кроме вершин, инцидентных им обоим.

**Опр.** Граф называют **планарным**, если можно выполнить его укладку на плоскость
**Опр.** Граф называют **плоским**, если он уже уложен на плоскости.

**Пример планарного графа.** Здесь $f_i$ - грани графа.
![[Pasted image 20240610190545.png]]

**Опр.** Область плоскости, ограниченная простым циклом плоского графа и не содержащая
никакой другой цикл, называется **внутренней гранью** плоского графа. Вся внешняя по
отношению к плоскому графу область плоскости называется его **внешней гранью**.
В приведенном примере $f_1,f_2,f_4$ - внутренние грани, а $f_3$ - внешняя грань.

**Теорема Эйлера о плоском графе.** Для связного плоского графа с $n$ вершинами, $m$ ребрами и $r$ гранями справедливо равенство: $n - m + r = 2$. 

**Следствие 1.** Если количество вершин графа $n \geq 3$, то $m \leq 3(n - 2)$. (Неравенство Эйлера)
**Следствие 2.** В каждом планарном графе существует вершина, степень которой не
больше 5.
**Доказательство (от противного)**. Путь $G(X,U)$ - планарный граф. Пусть для всякой вершины $x_i \in X: p(x_i) \geq 6$. Тогда $\Sigma_{ x_i \in X}$ $p(x_i) \geq 6n$. Согласно "лемме о рукопожатиях" (исторически первая теорема теории графов, доказанная Л. Эйлером) $\Sigma_{ x_i \in X}$ $p(x_i) = 2m$, где $m = | U |$. Следовательно, $2m \geq 6n$ или $m \geq 3n$.
Согласно следствию 1, $m \leq 3(n-2)$. Имеем, что $3n \leq m \leq  3n -6$, что невозможно. Получили противоречие, значит наше предположение неверно, что доказывает следствие 2. $\small\triangle$ 

**Пример применения теоремы: задача о домиках и колодцах**. Есть три дома и три колодца. Можно ли так проложить дорожки между домами и колодцами, чтобы от каждого дома к каждому колодцу вела дорожка, и никакие две дорожки не пересекались бы.
Из условия видно, что есть граф, где 6 вершин и 9 ребер. По теореме Эйлера, так как граф очевидно не имеет циклов длины 3, имеем, что количество ребер должно быть не больше 8. Получили противоречие. Значит такое соединение домов и колодцев невозможно.
(Граф $K_{3,3}$)

**Теорема о пяти красках.** Всякий планарный граф можно раскрасить 5-ю разными цветами.

---
#### 45. Гомеоморфизм графов. Теорема Понтрягина–Куратовского о планарном графе. Искаженность и толщина графа.
**Опр.** Два графа гомеоморфны, если они изоморфны (то есть отличаются только
изображениями) или могут быть приведены к изоморфизму путем конечного числа стягиваний и разбиений их ребер.

**Теорема Понтрягина-Куратовского.** Граф планарен тогда и только тогда, когда он не содержит подграфов, гомеоморфных полному графу из пяти вершин ($K_5$) или графу "домики колодцы" ($K_{3,3}$).

![[Pasted image 20240610193507.png]]
**Опр.** Искаженностью графа называется **наименьшее число ребер, удаление которых из приводит к планарному графу**
**Опр.** Наименьшее число планарных подграфов графа $G$, объединение которых дает
исходный граф $G$, называют **толщиной графа** и обозначают $t(G)$ . Очевидно, толщина
планарного графа равна единице: $t(G) = 1$, $G$ – планарный граф.

---
#### 46. Деревья. Основные свойства деревьев. Ориентированные деревья. Бинарные деревья. Дерево решений.
**Опр.** **Неориентированное дерево** - связный неограф без циклов.
**Опр.** Произвольный неограф без циклов называется **лесом.**

**Свойства деревьев:**
Пусть $G(X,U)$ - неориентированное дерево. $| X | = n, | U | = m$ Тогда:
- $m=n-1$
- Если $x_i,x_j \in X$, то их соединяет единственная простая цепь. Существование цепи следует из связности дерева, а единственность - из отсутствия циклов.
- Если $x_i,x_j \in X$ несмежные, то введение в дерева ребра $(x_i,x_j)$ даёт граф, содержащий ровно 1 цикл.
- Всякое неориентированное дерево содержит, по крайней мере, две концевые вершины.
- **Теорема Кайли.** Число различных деревьев, которые можно построить на $n$ различных вершинах, равно $n^{n-2}$.

**Опр.** Орграф $G(X,U)$ называется ордеревом, если выполняются следующие условия:
1) Существует ровно одна вершина, не имеющая предшествующих вершин ($p^+(x_1) = 0$).
2) Полустепень захода всех остальных вершин равна 1 ($\forall x_i \neq x_1: p^+(x_i) =1$).

**Опр.** Висячие вершины дерева называются **листьями**.
**Опр.** Путь из корня в лист называется **ветвью**.
**Опр.** Длина наибольшей ветви называется **высотой**.
**Опр.** Расстояние (число ребер) от корня до некоторой вершины называется **уровнем этой вершины**, а все вершины одного уровня называются **ярусом**.

**Опр.** Если полустепень исхода каждой вершины ордерева, отличной от листа, равна 2, и все листья дерева располагаются на одном ярусе, то такое ордерево называется (полным) бинарным.

**Опр.** Все сравнения, которые проводятся при сортировке, приводят к формированию ордерева, которое называется **деревом решений**.
**Пример.** Для $\lbrace a,b,c\rbrace$.
![[Pasted image 20240610195443.png]]
Дерево решений имеет $n!$ вершин, тогда сортировка даёт пути от корня к каждому листу. Число операций пропорционально высоте дерева - $\log_{2}(n!)$
Приближение для $n! \approx \sqrt{ 2\pi n } \large\left( \frac{n}{e} \right)^n$
Тогда получим минимально возможную сложность для алгоритма классической сортировки $O(n \log n)$

---
#### 47. Остовы. Циклический и коциклический ранги. Задача Штейнера.
**Опр.** Граф  $G^`(X^`,U^`)$  называется остовным подграфом $G(X,U)$, если $X^` =X, U^` \subseteq U$. 
Если остовный подграф является деревом, то его называют остовным деревом или просто **остовом**.

**Теорема.** Число ребер произвольного графа $G$, которые надо удалить для получения остова, не зависит от порядка их удаления и равно $\nu(G) = m -n +k$, где $m = | U |, n = | X |, k$ - число компонент связности.

**Опр.** Циклическим рангом (числом) графа $\nu(G) = m -n +k$ называется число ребер, которые нужно удалить из графа для получения остова.
**Опр.** Коциклическим рангом (числом) графа $\nu^*(G) = n-k$ называется число ребер самого остова. 
**Прим.** $\nu(G) + \nu^*(G) = m$.

**Задача Штейнера.** На плоскости задано $n$ точек, нужно соединить эти точки отрезками прямых так, что сумма длин этих отрезков была минимальной. Разрешается добавлять точки и длина определяется весом ребра.

**Формулировка задачи Штейнера в теории графов:**
Дан неограф $G_0(X_0,\varnothing)$. Требуется найти неограф $G(X,U)$, такой, что:
1) Каждому ребру присвоено некоторое неотрицательное число (вес ребра.)
2) Искомый граф $G$ должен быть неодеревом. 
3) $X_0 \subseteq X$
4) Сумма весов ребер полученного дерева $G$ должна быть наименьшей.

**Пояснение.** $G$ - неориентированное дерево, потому что каждую пару вершин должна соединять только одна цепь, иначе сумма весов будет не минимальной, так как, если существуют 2 цепи, возникают альтернативные пути и неоднозначность решения.
Решения задачи Штейнера в общем случае не существует.
Решения при некоторых ограничениях: алгоритм Прима и алгоритм Краскала.


---
#### 48. Задача об остове экстремального веса. Алгоритм Прима.
**Задача об остове экстремального веса.** Это задача Штейнера с дополнением, что множество вершин в ходе реализации алгоритма остаётся постоянной и совпадает со множеством вершин исходного графа.

**Алгоритм Прима.** Алгоритм решения задачи об остове экстремального веса. В результате даёт остов максимального/минимального веса.
Дан граф $G(X,U,\Omega)$, где $\Omega$ - множество весов, $| U | = | \Omega |$, $\Omega = \lbrace \omega_1,\omega_2,...,\omega_n \rbrace$.
В основе алгоритма лежит расширение исходного поддерева до остова. Алгоритм итерационный, на каждой итерации число вершин и рёбер увеличивается не менее чем на 1.
Множество вершин разбивается на два подмножества: $X = X_1 \cup X_2, X_1 \cap X_2 = \varnothing$.
Введём понятие пошагового расстояния между $X_1$ и $X_2$:
$d(X_1,X_2) = min \lbrace\omega(x_i,x_j):x_i \in X_1, x_j \in X_2 \rbrace$.

**Шаги алгоритма:**
1) Присвоение начального значения. Полагаем $X_1 = \lbrace x_1 \rbrace$ и $X_2 = X \setminus X_1$. Множество ребер исходного остова: $U^` = \varnothing$.   
2) Обновление данных. Находим ребро $(x_i, x_j ) : x_i \in X_1, x_j \in X_2,\text { } \omega(x_i, x_j ) = d(X_1, X_2)$. Полагаем, что $X_1 = X_1 \cup \lbrace x_j \rbrace$; $U^` = U^` \cup \lbrace (x_i,x_j) \rbrace$; $X_2 = X \setminus X_1$;
3) Проверка на завершение. Если $X_1 = X$, то полученный остов имеет минимальный вес. Иначе: переход в шаг 2.
**Примечание.** Если требуется найти остов максимального веса, то в формуле $d(X_1,X_2)$ меняем $min$ на $max$.

---

#### 49. Кратчайшие пути в графе: постановка задачи. Отыскание кратчайшего пути в невзвешенном графе.

**Задача нахождения кратчайшего пути** - задача поиска самого короткого пути между двумя вершинами графа (s и t), в которой минимизируется сумма весов рёбер, составляющих путь.

При отыскании кратчайшего пути в невзвешенном графе используется алгоритм Бержа.
**Его шаги.**
1) Вершине S присваиваем метку "$0$".
2) Рассматриваем вершину $x_i$,имеющую метку, и для всех вершин $\in \Gamma_{x_i}$ ставим метку "$i+1$" 
и повторяем для каждой вершины.
3) Останавливаемся, когда помечен весь граф.
В результате выполнения алгоритма, метка вершины равна длине кратчайшего пути из s в 
эту вершину. Кратчайшим путем из s в заданную вершину является путь, на котором каждая следующая вершина имеет метку на 1 больше, чем предыдущая.

--- 

#### 50. Алгоритм Дейкстры отыскания кратчайшего пути во взвешенном графе.

Алгоритм Дейкстры используется для поиска кратчайшего пути во взвешенном графе без ребер с отрицательными весами.
**Его шаги.**
1) Присваиваем вершинам начальные метки. Начальной вершине s присваиваем метку $M(s) = 0$, остальным - $\infty$. Все вершины графа помечаются как не посещённые. 
2) Выбираем вершину с минимальной меткой $x_i$ и рассматриваем все вершины $x_j\in \Gamma_{x_i}$. Для каждой такой вершины проверяем условие: если $M(x_i) + \omega (x_i,x_j) < M(x_j)$, то $M(x_j) = M(x_i) + \omega (x_i,x_j)$. После рассмотрения всех вершин $x_j$ отмечаем вершину $x_i$ помеченной, и выбираем из ещё не посещенных такую, которое имеет минимальное значение метки.
3) Повторяем шаг 2, пока все вершины не будут помечены. Метка над каждой вершиной $M(x_j)$ и есть длина кратчайшего пути из s в вершину $x_j$.
4) Для поиска кратчайшего пути начинаем из конечной вершины $x_t$. Проверяем все вершины $x_j \in \Gamma^{-1}_{x_t}$ и находим те, удовлетворяющие условию: $M(x_i) + \omega(x_i,x_t) = M(x_t)$. Затем $x_t = x_i$ и повторяем этот шаг, пока $x_t$ не будет равно $x_s$. Получили кратчайший путь.
P.S. https://habr.com/ru/articles/111361/

--- 
#### 51. Алгоритм Беллмана–Форда отыскания кратчайшего пути во взвешенном графе.

Алгоритм Беллмана-Форда используется для поиска кратчайшего пути во взвешенном графе с ребрами с отрицательными весами.
**Его шаги.**
Дана матрица смежности в орграфе.
1) Присваиваем вершинам начальные метки. Заполняем строку и столбец метками. $M(s)=0$,и для $x_j \in X\setminus\lbrace s\rbrace: M(x_j)=\infty$    
2) Просматриваем любую, ещё не просмотренную строку матрицы, для каждой проверяем условие: если $M(x_i) + \omega(x_i,x_j) < M(x_j)$, то $M(x_j) = M(x_i) + \omega(x_i,x_j)$ (Тут $M(x_i)$ соответствует строке меток, а $M(x_j)$ - столбцу меток). Строку помечаем галочкой. 
3) Копируем строку меток в столбец меток. Снимаем галочку со строк, метки которых изменились.
4) Если все строки просмотрены, то завершаем алгоритм. $M(x_j)$ и есть длина кратчайшего пути из s в вершину $x_j$.
5) Для нахождения кратчайшего пути начинаем с конечной вершины $x_t$. Просматриваем столбец $x_t$ и находим вершину $x_i$, для которой выполняется условие: $M(x_t) = M(x_i)+\omega (x_i,x_t)$. Затем $x_t = x_i$ и повторяем шаг 5 пока $x_t$ не станет равным $x_s$. Получили кратчайший путь.

--- 
#### 52. Поток в транспортной сети: постановка задачи. Полный и максимальный поток в сети.

**Задача о потоке в транспортной сети** заключается в нахождении максимального потока в сети из истока в сток. 

**Опр.** Сетью называется ориентированный, взвешенный граф без петель, с одним источником и одним стоком.

**Опр.** **Полный поток** - если не существует путей из источника в сток, состоящего только из ненасыщенных путей, то текущее значение потока в сети называется полным потоком.

**Опр.** **Максимальный поток** - поток, величина которого является максимальной для данной сети. 

**Теорема.** Величина потока в сети является максимальной тогда и только тогда, когда в сети не существует увеличивающего маршрута.


--- 

#### 53. Поток в транспортной сети: увеличивающий маршрут и алгоритм его построения.
**Алгоритм Форда–Фалкерсона отыскания максимального потока в сети.**
 (Тоже, что и в домашке)
**Опр.** **Увеличивающий маршрут** - маршрут от источника к стоку, включающий прямые и обратные ребра, причем все прямые ребра ненасыщенные, а поток на всех обратных ребрах отличен от нуля.

**Алгоритм построения увеличивающего маршрута (алгоритм разметки вершин).**
1) Источник помечаем знаком “+”.
2) Для каждой вершины графа $x_i$ помечаем знаком “+i” все непомеченные вершины, в которые из $x_i$ ведут ненасыщенные ребра.
3) Для каждой вершины графа $x_i$ помечаем знаком “-i” все непомеченные вершины, из которых в $x_i$ ведут ребра с ненулевым потоком.
Когда непомеченных вершин не осталось, то проверяем сток:
	 Если он помечен, то увеличивающий маршрут существует.
	 Если он не помечен, то увеличивающего маршрута в сети нет.

Для поиска максимального потока используются следующие теоремы:
- **Теорема 1** – Если $(s,x_n,...,x_k,t)$ – путь от источника к стоку, состоящий только из ненасыщенных рёбер, то значение потока на всех его рёбрах можно увеличить на $δ^* = min_{\text{по всем дугам пути}} \lbrace\delta(x_i, x_j)\rbrace = min_{\text{по всем дугам пути}} \lbrace c(x_i, x_j) – \varphi(x_i, x_j)\rbrace$. При этом величина потока в сети возрастет на $δ^*$.

- **Теорема 2** – Если $(s,x_n,...,x_k,t)$ – увеличивающий маршрут, то значение потока на его прямых рёбрах можно увеличить, а на обратных ребрах, уменьшить на величину $\epsilon^* = min\lbrace\delta^*, \varphi^*\rbrace$, где: $\delta^* = min_{\text{по прямым ребрам}} \lbrace \delta(x_i, x_j)\rbrace = min_{\text{по прямым ребрам}}\lbrace c(x_i, x_j) – \varphi(x_i, x_j)\rbrace$, а $\varphi^* = min_{\text{по обратным ребрам}} \lbrace \varphi(x_i, x_j)\rbrace$. При этом величина потока в сети возрастает на ε*.

- **Теорема 3** - Величина потока в сети является максимальной тогда и только тогда, когда в сети не существует увеличивающего маршрута.

- **Теорема 4 (Форда-Фалкерсона)** – Для любой сети с одним источником и одним стоком величина максимального потока в сети, доставляемого от источника к стоку, равна пропускной способности минимального разреза. $\varphi_{max} = c_{min}$.

**Алгоритм Форда-Фалкерсона отыскания максимального потока в сети.**
1) Присвоение начального потока сети. 
	Находим источник и сток. Начальный поток равен 0.
2) Достижение полного потока. (Теорема 1)
3) Нахождение максимального потока сети. (Теорема 2 + Теорема 3).
4) Нахождение минимального разреза. (Теорема 4).

После выполнения данного алгоритма полученный поток в сети является максимальным.

---
#### 54. Понятие разреза транспортной сети. Минимальный разрез. Теорема Форда–Фалкерсона о максимальном потоке в сети.

**Опр.** **Разрез транспортной сети** - множество ребер, удаление которых из графа делает его несвязным, причем нельзя добраться из источника в сток.

**Опр.** **Минимальный разрез сети** - ориентированный разрез сети, имеющий минимальную пропускную способность из всех возможных, причем он состоит только из насыщенных ребер.

**Теорема Форда-Фалкерсона**. Для любой сети с одним источником и одним стоком величина максимального потока в сети, доставляемого от источника к стоку, равна пропускной способности минимального разреза.

---